load "Metriques/P1L2H1"load "Metriques/P2H1"load "Metriques/P2L2"real c=10;func real f(real X, real Y){return X^2*Y + Y^3 + tanh(c*(-2*X + sin(5*Y)));};func real sech(real X){return 2./(exp(X)+exp(-X));};func real fxx(real X, real Y){return 2*(Y - 4*c^2*sech(c*(-2*X + sin(5*Y)))^2*tanh(c*(-2*X + sin(5*Y))));};func real fxy(real X, real Y){return 2*(X + 10*c^2*cos(5*Y)*sech(c*(-2*X + sin(5*Y)))^2*tanh(c*(-2*X + sin(5*Y))));};func real fyy(real X, real Y){return 6*Y - 25*c*sech(c*(-2*X + sin(5*Y)))^2*(sin(5*Y) + 2*c*cos(5*Y)^2*tanh(c*(-2*X + sin(5*Y))));};//func normd2f = sqrt(fxx^2+2*fxy^2+fyy^2);func real fxxx(real X, real Y){return -16*c^3*(-2 + cosh(2*c*(-2*X + sin(5*Y))))*sech(c*(-2*X + sin(5*Y)))^4;};func real fxxy(real X, real Y){return 2 - 40*c^3*cos(5*Y)*sech(c*(-2*X + sin(5*Y)))^4 + 80*c^3*cos(5*Y)*sech(c*(-2*X + sin(5*Y)))^2*tanh(c*(-2*X + sin(5*Y)))^2;};func real fxyy(real X, real Y){return 100*c^2*sech(c*(-2*X + sin(5*Y)))^2*(c*cos(5*Y)^2*sech(c*(-2*X + sin(5*Y)))^2 - tanh(c*(-2*X + sin(5*Y)))*(sin(5*Y) + 2*c*cos(5*Y)^2*tanh(c*(-2*X + sin(5*Y)))));};func real fyyy(real X, real Y){return 6 - 250*c^3*cos(5*Y)^3*sech(c*(-2*X + sin(5*Y)))^4 + 125*c*sech(c*(-2*X + sin(5*Y)))^2*(-cos(5*Y) + 3*c*sin(10*Y)*tanh(c*(-2*X + sin(5*Y))) + 4*c^2*cos(5*Y)^3*tanh(c*(-2*X + sin(5*Y)))^2);};//func normd3f = sqrt(fxxx^2+3*fxxy^2+3*fxyy^2+fyyy^2);cout<< "test 2. 2. " << endl;cout << MetricP2L2xx(fxxx(2.,2.), fxxy(2.,2.), fxyy(2.,2.), fyyy(2.,2.)) << endl;cout << MetricP2L2xy(fxxx(2.,2.), fxxy(2.,2.), fxyy(2.,2.), fyyy(2.,2.)) << endl;cout << MetricP2L2yy(fxxx(2.,2.), fxxy(2.,2.), fxyy(2.,2.), fyyy(2.,2.)) << endl;cout << endl << "valeurs" << endl;cout << fxxx(2.,2.) << "  " <<  fxxy(2.,2.) << "  " <<  fxyy(2.,2.) << "  " << fyyy(2.,2.) << endl;cout << endl << "test 1.,0.,1.,0." << endl;cout << MetricP2L2xx(1., 0., 1., 0.) << endl;cout << MetricP2L2xy(1., 0., 1., 0.) << endl;cout << MetricP2L2yy(1., 0., 1., 0.) << endl;cout << endl << "test 0.01,2.,0.,6." << endl;cout << MetricP2L2xx(0.01, 2., 0., 6.) << endl;cout << MetricP2L2xy(0.01, 2., 0., 6.) << endl;cout << MetricP2L2yy(0.01, 2., 0., 6.) << endl;cout << "expected 1.11, 0.00278, 3.34" << endl;cout << endl << "test 0.,2.,0.,6." << endl;cout << MetricP2L2xx(0.0, 2., 0., 6.) << endl;cout << MetricP2L2xy(0.0, 2., 0., 6.) << endl;cout << MetricP2L2yy(0.0, 2., 0., 6.) << endl;